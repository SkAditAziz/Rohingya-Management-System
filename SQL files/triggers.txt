CREATE OR REPLACE TRIGGER T_RELIEF_AMOUNT
AFTER INSERT
ON RELIEF_AMOUNT
FOR EACH ROW
DECLARE
T_ITEM_ID NUMBER;
T_ITEM_AMOUNT NUMBER;
BEGIN
T_ITEM_ID := :NEW.ITEM_ID;
T_ITEM_AMOUNT := :NEW.ITEM_AMOUNT;
UPDATE RELIEF_STORAGE SET ITEM_UNIT=ITEM_UNIT-T_ITEM_AMOUNT WHERE ITEM_ID=T_ITEM_ID;
END;
/


CREATE OR REPLACE FUNCTION GET_BIRTH_RATE(CID IN NUMBER)
RETURN NUMBER IS
TOTALPEOPLE NUMBER;
TOTALCHILD NUMBER;
BR NUMBER ;
BEGIN
SELECT count(*)INTO TOTALCHILD
FROM NEW_BORN INNER JOIN ROHINGYA 
ON ROHINGYA.ROHINGYA_ID=NEW_BORN.MOTHER_ID
GROUP BY ROHINGYA.CAMP_ID
HAVING ROHINGYA.CAMP_ID = CID;

SELECT COUNT(*) INTO TOTALPEOPLE
FROM ROHINGYA
WHERE CAMP_ID = CID;

BR := (TOTALCHILD / TOTALPEOPLE) * 1000;

RETURN BR ; --return the message
END ;
/


DECLARE 
	BIRTH NUMBER;
BEGIN
	BIRTH := GET_BIRTH_RATE(201705);
	DBMS_OUTPUT.PUT_LINE(ROUND(BIRTH,2));
END;
/